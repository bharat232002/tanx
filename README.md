import pandas as pd
from datetime import datetime
from collections import defaultdict

def read_orders_csv(file_path):
    return pd.read_csv(file_path)

def compute_monthly_revenue(orders_df):
    orders_df['order_date'] = pd.to_datetime(orders_df['order_date'])
    orders_df['month'] = orders_df['order_date'].dt.to_period('M')
    monthly_revenue = orders_df.groupby('month')['product_price'].sum()
    return monthly_revenue

def compute_product_revenue(orders_df):
    product_revenue = orders_df.groupby('product_name')['product_price'].sum()
    return product_revenue

def compute_customer_revenue(orders_df):
    customer_revenue = orders_df.groupby('customer_id')['product_price'].sum()
    return customer_revenue

def identify_top_customers(orders_df, n=10):
    top_customers = orders_df.groupby('customer_id')['product_price'].sum().nlargest(n)
    return top_customers

if _name_ == "_main_":
    # Read data from CSV
    orders_df = read_orders_csv('orders.csv')

    # Task 1: Compute total revenue generated by each month
    monthly_revenue = compute_monthly_revenue(orders_df)
    print("Monthly Revenue:\n", monthly_revenue)

    # Task 2: Compute total revenue generated by each product
    product_revenue = compute_product_revenue(orders_df)
    print("\nProduct Revenue:\n", product_revenue)

    # Task 3: Compute total revenue generated by each customer
    customer_revenue = compute_customer_revenue(orders_df)
    print("\nCustomer Revenue:\n", customer_revenue)

    # Task 4: Identify top 10 customers by revenue generated
    top_customers = identify_top_customers(orders_df)
    print("\nTop 10 Customers:\n", top_customers)
